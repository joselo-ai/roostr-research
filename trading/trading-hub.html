<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêì ROOSTR Trading Hub - Full Pipeline</title>
    <script src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #0a0a0a;
            --bg-card: #1a1a1a;
            --bg-hover: #252525;
            --color-green: #4ade80;
            --color-red: #f87171;
            --color-yellow: #fbbf24;
            --color-blue: #60a5fa;
            --color-text: #e5e5e5;
            --color-text-dim: #a1a1a1;
            --border-color: #333;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'SF Pro Display', sans-serif;
            background: var(--bg-primary);
            color: var(--color-text);
            overflow-x: hidden;
        }

        /* Enhanced Header with Strategy Breakdown */
        .header {
            background: linear-gradient(135deg, #1a1a1a 0%, #252525 100%);
            padding: 1.5rem 2rem;
            border-bottom: 1px solid var(--border-color);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .header-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .header-title {
            font-size: 1.5rem;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .header-stats {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 2rem;
            font-size: 0.95rem;
        }

        .stat {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .stat-label {
            color: var(--color-text-dim);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .stat-value {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .stat-value.positive { color: var(--color-green); }
        .stat-value.negative { color: var(--color-red); }

        /* Strategy Allocation Bar */
        .strategy-bar {
            margin-top: 1rem;
            padding: 0.75rem 0;
            border-top: 1px solid var(--border-color);
        }

        .strategy-bar-label {
            font-size: 0.75rem;
            color: var(--color-text-dim);
            margin-bottom: 0.5rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .strategy-bar-track {
            display: flex;
            height: 8px;
            background: var(--bg-hover);
            border-radius: 4px;
            overflow: hidden;
        }

        .strategy-segment {
            height: 100%;
            transition: all 0.3s;
            position: relative;
        }

        .strategy-segment:hover {
            filter: brightness(1.2);
        }

        /* Main Grid Layout */
        .trading-grid {
            display: grid;
            grid-template-columns: 25% 50% 25%;
            grid-template-rows: auto auto auto;
            gap: 1rem;
            padding: 1rem;
            min-height: calc(100vh - 160px);
        }

        /* Card Styles */
        .card {
            background: var(--bg-card);
            border-radius: 8px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
            overflow: auto;
        }

        .card-header {
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--color-text-dim);
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* Strategy Allocation Panel (Top Left) */
        .strategy-panel {
            grid-column: 1;
            grid-row: 1;
        }

        .strategy-bucket {
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.5) 0%, rgba(37, 37, 37, 0.3) 100%);
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            border-left: 3px solid;
        }

        .strategy-bucket.value { border-left-color: var(--color-blue); }
        .strategy-bucket.social { border-left-color: var(--color-yellow); }
        .strategy-bucket.crypto { border-left-color: var(--color-green); }
        .strategy-bucket.opportunistic { border-left-color: var(--color-red); }

        .strategy-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .strategy-name {
            font-weight: 700;
            font-size: 0.95rem;
        }

        .strategy-allocation {
            font-size: 0.85rem;
            color: var(--color-text-dim);
        }

        .strategy-progress {
            height: 6px;
            background: var(--bg-hover);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 0.5rem;
        }

        .strategy-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--color-green) 0%, var(--color-blue) 100%);
            transition: width 0.3s;
        }

        .strategy-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            font-size: 0.8rem;
            color: var(--color-text-dim);
        }

        /* Positions Panel */
        .positions-panel {
            grid-column: 1;
            grid-row: 2 / 4;
        }

        .position-row {
            background: linear-gradient(135deg, rgba(26, 26, 26, 0.5) 0%, rgba(37, 37, 37, 0.3) 100%);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            padding: 1rem;
            margin-bottom: 0.75rem;
            transition: all 0.2s;
        }

        .position-row:hover {
            border-color: var(--color-yellow);
            box-shadow: 0 0 10px rgba(251, 191, 36, 0.2);
        }

        .position-row.deployed {
            border-left: 3px solid var(--color-green);
        }

        .position-row.pending {
            border-left: 3px solid var(--color-yellow);
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.05) 0%, rgba(26, 26, 26, 0.5) 100%);
        }

        .position-row.positive {
            border-left: 3px solid var(--color-green);
        }

        .position-row.negative {
            border-left: 3px solid var(--color-red);
        }

        .position-status {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-size: 0.7rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .position-status.deployed {
            background: rgba(74, 222, 128, 0.2);
            color: var(--color-green);
        }

        .position-status.pending {
            background: rgba(251, 191, 36, 0.2);
            color: var(--color-yellow);
        }

        .position-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .position-symbol {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .position-pnl {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .position-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            font-size: 0.85rem;
            color: var(--color-text-dim);
            margin-bottom: 0.75rem;
        }

        .position-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s;
            flex: 1;
        }

        .btn-primary {
            background: var(--color-green);
            color: #000;
        }

        .btn-primary:hover {
            background: #22c55e;
            transform: translateY(-1px);
        }

        .btn-secondary {
            background: var(--bg-hover);
            color: var(--color-text);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: #333;
        }

        .btn-danger {
            background: var(--color-red);
            color: #fff;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .btn-add {
            width: 100%;
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            color: #fff;
            padding: 0.75rem;
            font-size: 1rem;
            margin-top: 1rem;
        }

        /* Chart Panel */
        .chart-panel {
            grid-column: 2;
            grid-row: 1 / 4;
        }

        #chart-container {
            width: 100%;
            height: calc(100% - 60px);
            margin-top: 1rem;
        }

        .chart-controls {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .chart-btn {
            padding: 0.4rem 0.8rem;
            background: var(--bg-hover);
            border: 1px solid var(--border-color);
            color: var(--color-text);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.2s;
        }

        .chart-btn.active {
            background: var(--color-green);
            color: #000;
            border-color: var(--color-green);
        }

        .chart-btn:hover {
            border-color: var(--color-green);
        }

        /* Signals Database Panel */
        .signals-panel {
            grid-column: 3;
            grid-row: 1 / 3;
            max-height: 80vh;
        }

        .signals-filter {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .filter-btn {
            padding: 0.4rem 0.8rem;
            background: var(--bg-hover);
            border: 1px solid var(--border-color);
            color: var(--color-text);
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.75rem;
            transition: all 0.2s;
            flex: 1;
            text-align: center;
        }

        .filter-btn.active {
            background: var(--color-green);
            color: #000;
            border-color: var(--color-green);
        }

        .signal-row {
            background: var(--bg-hover);
            border-radius: 4px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.2s;
            border-left: 3px solid;
        }

        .signal-row.deployed { border-left-color: var(--color-green); }
        .signal-row.pending { border-left-color: var(--color-yellow); }
        .signal-row.watching { border-left-color: var(--color-blue); }
        .signal-row.passed { border-left-color: var(--color-red); }

        .signal-row:hover {
            background: #333;
            transform: translateX(2px);
        }

        .signal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }

        .signal-symbol {
            font-weight: 700;
            font-size: 0.95rem;
        }

        .signal-conviction {
            font-size: 0.85rem;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-weight: 700;
        }

        .signal-conviction.high {
            background: rgba(74, 222, 128, 0.2);
            color: var(--color-green);
        }

        .signal-conviction.medium {
            background: rgba(251, 191, 36, 0.2);
            color: var(--color-yellow);
        }

        .signal-conviction.low {
            background: rgba(161, 161, 161, 0.2);
            color: var(--color-text-dim);
        }

        .signal-details {
            font-size: 0.8rem;
            color: var(--color-text-dim);
        }

        /* Market Data Panel */
        .market-panel {
            grid-column: 3;
            grid-row: 3;
        }

        .quote-main {
            text-align: center;
            padding: 1rem;
            background: linear-gradient(135deg, rgba(74, 222, 128, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
            border-radius: 6px;
            margin-bottom: 1rem;
        }

        .quote-symbol {
            font-size: 0.9rem;
            color: var(--color-text-dim);
            margin-bottom: 0.5rem;
        }

        .quote-price {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .quote-change {
            font-size: 1rem;
            font-weight: 600;
        }

        .quote-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
            font-size: 0.75rem;
            margin-top: 0.75rem;
        }

        .quote-stat {
            text-align: left;
        }

        .quote-stat-label {
            color: var(--color-text-dim);
            margin-bottom: 0.25rem;
        }

        /* Emergency Controls */
        .emergency-controls {
            position: fixed;
            top: 1rem;
            right: 1rem;
            display: flex;
            gap: 0.5rem;
            z-index: 1000;
        }

        .emergency-btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.9rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            transition: all 0.2s;
        }

        .emergency-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }

        /* Loading Indicator */
        .loading {
            text-align: center;
            padding: 2rem;
            color: var(--color-text-dim);
        }

        .spinner {
            display: inline-block;
            width: 30px;
            height: 30px;
            border: 3px solid var(--bg-hover);
            border-top-color: var(--color-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .trading-grid {
                grid-template-columns: 35% 65%;
                grid-template-rows: auto auto auto auto;
            }
            .strategy-panel {
                grid-column: 1;
                grid-row: 1;
            }
            .positions-panel {
                grid-column: 1;
                grid-row: 2 / 4;
            }
            .chart-panel {
                grid-column: 2;
                grid-row: 1 / 3;
            }
            .signals-panel {
                grid-column: 2;
                grid-row: 3;
            }
            .market-panel {
                grid-column: 1 / 3;
                grid-row: 4;
            }
        }

        @media (max-width: 768px) {
            .trading-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto;
            }
            .strategy-panel, .positions-panel, .chart-panel, .signals-panel, .market-panel {
                grid-column: 1;
                grid-row: auto;
            }
            .header-stats {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
    </style>
</head>
<body>
    <!-- Enhanced Header -->
    <header class="header">
        <div class="header-row">
            <div class="header-title">üêì ROOSTR TRADING HUB</div>
            <div class="stat">
                <div class="stat-label">Status</div>
                <div class="stat-value pulse" style="color: var(--color-green)">üü¢ LIVE</div>
            </div>
        </div>
        <div class="header-stats">
            <div class="stat">
                <div class="stat-label">Total Capital</div>
                <div class="stat-value">$100,000</div>
            </div>
            <div class="stat">
                <div class="stat-label">Deployed</div>
                <div class="stat-value" id="deployed-value">$17,500</div>
            </div>
            <div class="stat">
                <div class="stat-label">Pending</div>
                <div class="stat-value" style="color: var(--color-yellow)" id="pending-value">$45,000</div>
            </div>
            <div class="stat">
                <div class="stat-label">Available Cash</div>
                <div class="stat-value" id="cash-value">$37,500</div>
            </div>
            <div class="stat">
                <div class="stat-label">Positions</div>
                <div class="stat-value"><span id="deployed-count">2</span> + <span id="pending-count" style="color: var(--color-yellow)">3</span></div>
            </div>
            <div class="stat">
                <div class="stat-label">Total P&L</div>
                <div class="stat-value negative" id="total-pnl">-$464</div>
            </div>
        </div>
        <div class="strategy-bar">
            <div class="strategy-bar-label">Capital Allocation by Strategy</div>
            <div class="strategy-bar-track">
                <div class="strategy-segment" style="width: 40%; background: var(--color-blue);" title="Value Investing: 40% ($40k)"></div>
                <div class="strategy-segment" style="width: 30%; background: var(--color-yellow);" title="Social Arbitrage: 30% ($30k)"></div>
                <div class="strategy-segment" style="width: 20%; background: var(--color-green);" title="Crypto Fundamentals: 20% ($20k)"></div>
                <div class="strategy-segment" style="width: 10%; background: var(--color-red);" title="Opportunistic: 10% ($10k)"></div>
            </div>
        </div>
    </header>

    <!-- Emergency Controls -->
    <div class="emergency-controls">
        <button class="emergency-btn" style="background: var(--color-red); color: #fff;" onclick="closeAllPositions()">
            üî¥ CLOSE ALL
        </button>
        <button class="emergency-btn" style="background: var(--color-yellow); color: #000;" onclick="pauseTrading()">
            ‚è∏Ô∏è PAUSE
        </button>
        <button class="emergency-btn" style="background: var(--color-green); color: #000;" onclick="showRiskCheck()">
            üìä RISK CHECK
        </button>
    </div>

    <!-- Main Trading Grid -->
    <div class="trading-grid">
        <!-- Strategy Allocation Panel (Top Left) -->
        <div class="card strategy-panel">
            <div class="card-header">STRATEGY ALLOCATION</div>
            
            <div class="strategy-bucket value">
                <div class="strategy-header">
                    <div class="strategy-name">Value Investing</div>
                    <div class="strategy-allocation">40% ($40k)</div>
                </div>
                <div class="strategy-progress">
                    <div class="strategy-progress-bar" style="width: 87.5%; background: var(--color-blue);"></div>
                </div>
                <div class="strategy-stats">
                    <div>Deployed: $35,000</div>
                    <div>Available: $5,000</div>
                    <div>Positions: 3 pending</div>
                    <div style="color: var(--color-green);">P&L: TBD</div>
                </div>
            </div>

            <div class="strategy-bucket social">
                <div class="strategy-header">
                    <div class="strategy-name">Social Arbitrage</div>
                    <div class="strategy-allocation">30% ($30k)</div>
                </div>
                <div class="strategy-progress">
                    <div class="strategy-progress-bar" style="width: 0%; background: var(--color-yellow);"></div>
                </div>
                <div class="strategy-stats">
                    <div>Deployed: $0</div>
                    <div>Available: $30,000</div>
                    <div>Positions: 0</div>
                    <div style="color: var(--color-text-dim);">P&L: $0</div>
                </div>
            </div>

            <div class="strategy-bucket crypto">
                <div class="strategy-header">
                    <div class="strategy-name">Crypto Fundamentals</div>
                    <div class="strategy-allocation">20% ($20k)</div>
                </div>
                <div class="strategy-progress">
                    <div class="strategy-progress-bar" style="width: 87.5%; background: var(--color-green);"></div>
                </div>
                <div class="strategy-stats">
                    <div>Deployed: $17,500</div>
                    <div>Available: $2,500</div>
                    <div>Positions: 2</div>
                    <div style="color: var(--color-red);">P&L: -$464</div>
                </div>
            </div>

            <div class="strategy-bucket opportunistic">
                <div class="strategy-header">
                    <div class="strategy-name">Opportunistic</div>
                    <div class="strategy-allocation">10% ($10k)</div>
                </div>
                <div class="strategy-progress">
                    <div class="strategy-progress-bar" style="width: 0%; background: var(--color-red);"></div>
                </div>
                <div class="strategy-stats">
                    <div>Deployed: $0</div>
                    <div>Available: $10,000</div>
                    <div>Positions: 0</div>
                    <div style="color: var(--color-text-dim);">P&L: $0</div>
                </div>
            </div>
        </div>

        <!-- Positions Panel (Left) -->
        <div class="card positions-panel">
            <div class="card-header">
                ALL POSITIONS
                <span id="positions-total-pnl">2 DEPLOYED + 3 PENDING</span>
            </div>
            <div id="positions-container">
                <!-- Positions will be loaded here -->
            </div>
        </div>

        <!-- Chart Panel (Center) -->
        <div class="card chart-panel">
            <div class="card-header">
                <span id="chart-title">TAO/USD - BITTENSOR</span>
                <span id="chart-price">$166.28</span>
            </div>
            <div class="chart-controls">
                <button class="chart-btn active" data-interval="5m">5m</button>
                <button class="chart-btn" data-interval="15m">15m</button>
                <button class="chart-btn" data-interval="1h">1h</button>
                <button class="chart-btn" data-interval="4h">4h</button>
                <button class="chart-btn" data-interval="1D">1D</button>
                <button class="chart-btn" data-interval="1W">1W</button>
            </div>
            <div id="chart-container"></div>
        </div>

        <!-- Signals Database Panel (Top Right) -->
        <div class="card signals-panel">
            <div class="card-header">
                SIGNALS DATABASE
                <span id="signals-count">25 signals</span>
            </div>
            <div class="signals-filter">
                <button class="filter-btn active" data-filter="all">ALL</button>
                <button class="filter-btn" data-filter="deployed">DEPLOYED</button>
                <button class="filter-btn" data-filter="pending">PENDING</button>
                <button class="filter-btn" data-filter="watching">WATCHING</button>
            </div>
            <div id="signals-container">
                <!-- Signals will be loaded here -->
            </div>
        </div>

        <!-- Market Data Panel (Bottom Right) -->
        <div class="card market-panel">
            <div class="card-header">MARKET DATA</div>
            <div class="quote-main" id="quote-main">
                <div class="quote-symbol">TAO (Bittensor)</div>
                <div class="quote-price" id="quote-price">$166.28</div>
                <div class="quote-change negative" id="quote-change">-5.6% ‚ñº</div>
                <div class="quote-stats">
                    <div class="quote-stat">
                        <div class="quote-stat-label">Entry</div>
                        <div id="quote-entry">$176.05</div>
                    </div>
                    <div class="quote-stat">
                        <div class="quote-stat-label">Stop Loss</div>
                        <div id="quote-stop">$140.84</div>
                    </div>
                    <div class="quote-stat">
                        <div class="quote-stat-label">Target</div>
                        <div id="quote-target">$211.26</div>
                    </div>
                    <div class="quote-stat">
                        <div class="quote-stat-label">Last Update</div>
                        <div id="quote-update" class="pulse" style="color: var(--color-green)">2s ago üü¢</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===========================================
        // ROOSTR TRADING HUB - FULL PIPELINE
        // ===========================================

        let chart = null;
        let candlestickSeries = null;
        let currentSymbol = 'TAO';
        let currentInterval = '5m';
        let positions = [];
        let signals = [];
        let currentFilter = 'all';
        let lastUpdate = Date.now();

        // Signals Database (from CSV)
        const signalsDatabase = [
            { ticker: 'TAO', conviction: 9, status: 'deployed', deployed: true, pnl: -555, pnlPct: -5.55, entry: 176.05, current: 166.28, stop: 140.84, target: 211.26, source: 'Yieldschool-Dan', strategy: 'crypto' },
            { ticker: 'SOL', conviction: 8, status: 'deployed', deployed: true, pnl: 91, pnlPct: 1.21, entry: 86.51, current: 87.56, stop: 73.53, target: 103.81, source: 'Yieldschool-Hub', strategy: 'crypto' },
            { ticker: 'ALL', conviction: 10, status: 'pending', deployed: false, entry: 208, stop: 191.36, target: 260, size: 20000, source: 'Value-Research', strategy: 'value', executeDate: '2026-02-09 09:30' },
            { ticker: 'PGR', conviction: 9, status: 'pending', deployed: false, entry: 201, stop: 184.92, target: 250, size: 15000, source: 'Value-Research', strategy: 'value', executeDate: '2026-02-09 09:30' },
            { ticker: 'KTB', conviction: 7.5, status: 'pending', deployed: false, entry: 67, stop: 60.30, target: 84, size: 10000, source: 'DumbMoney', strategy: 'value', executeDate: '2026-02-09 09:30' },
            { ticker: 'ASTS', conviction: 7, status: 'watching', deployed: false, source: 'DumbMoney', strategy: 'opportunistic' },
            { ticker: 'RNDR', conviction: 7, status: 'watching', deployed: false, source: 'Yieldschool-MidCaps', strategy: 'crypto' },
            { ticker: 'EURUSD', conviction: 9, status: 'watching', deployed: false, source: 'ChartFanatics-Riz', strategy: 'opportunistic' },
            { ticker: 'FET', conviction: 6, status: 'watching', deployed: false, source: 'Yieldschool-LowCaps', strategy: 'crypto' },
            { ticker: 'TAC', conviction: 6, status: 'watching', deployed: false, source: 'DumbMoney', strategy: 'opportunistic' },
            { ticker: 'AS', conviction: 4, status: 'passed', deployed: false, source: 'DumbMoney', strategy: 'opportunistic' },
            { ticker: 'PYPL', conviction: 5, status: 'watching', deployed: false, source: 'DumbMoney', strategy: 'opportunistic' },
            { ticker: 'NVDA', conviction: 10, status: 'watching', deployed: false, source: 'Reddit', strategy: 'social' },
            { ticker: 'PLTR', conviction: 9, status: 'watching', deployed: false, source: 'Reddit', strategy: 'social' },
            { ticker: 'PE', conviction: 7, status: 'watching', deployed: false, source: 'Reddit', strategy: 'opportunistic' },
            { ticker: 'BYD', conviction: 7, status: 'watching', deployed: false, source: 'Reddit', strategy: 'social' },
            { ticker: 'TSLA', conviction: 7, status: 'watching', deployed: false, source: 'Reddit', strategy: 'social' },
            { ticker: 'AMD', conviction: 8, status: 'watching', deployed: false, source: 'Reddit', strategy: 'social' },
            { ticker: 'T', conviction: 5, status: 'watching', deployed: false, source: 'Reddit', strategy: 'opportunistic' },
            { ticker: 'IONQ', conviction: 5, status: 'watching', deployed: false, source: 'Reddit', strategy: 'opportunistic' },
            { ticker: 'EOG', conviction: 8, status: 'watching', deployed: false, source: 'Value-Research', strategy: 'value' },
            { ticker: 'TRV', conviction: 8, status: 'watching', deployed: false, source: 'Value-Research', strategy: 'value' },
            { ticker: 'LULU', conviction: 7, status: 'watching', deployed: false, source: 'Value-Research', strategy: 'value' },
        ];

        // Initialize
        window.onload = function() {
            console.log('üêì ROOSTR Trading Hub - Initializing Full Pipeline...');
            initChart();
            loadPositions();
            loadSignals();
            startPriceUpdates();
            setupEventListeners();
        };

        // Initialize Chart
        function initChart() {
            const container = document.getElementById('chart-container');
            chart = LightweightCharts.createChart(container, {
                width: container.clientWidth,
                height: container.clientHeight,
                layout: {
                    background: { color: '#0a0a0a' },
                    textColor: '#e5e5e5',
                },
                grid: {
                    vertLines: { color: '#1a1a1a' },
                    horzLines: { color: '#1a1a1a' },
                },
                crosshair: {
                    mode: LightweightCharts.CrosshairMode.Normal,
                },
                rightPriceScale: {
                    borderColor: '#333',
                },
                timeScale: {
                    borderColor: '#333',
                    timeVisible: true,
                },
            });

            candlestickSeries = chart.addCandlestickSeries({
                upColor: '#4ade80',
                downColor: '#f87171',
                borderVisible: false,
                wickUpColor: '#4ade80',
                wickDownColor: '#f87171',
            });

            loadChartData(currentSymbol, currentInterval);

            window.addEventListener('resize', () => {
                chart.applyOptions({ 
                    width: container.clientWidth,
                    height: container.clientHeight
                });
            });
        }

        // Load chart data (mock)
        function loadChartData(symbol, interval) {
            const signal = signalsDatabase.find(s => s.ticker === symbol);
            const basePrice = signal?.current || signal?.entry || 100;
            
            const data = [];
            const now = Date.now() / 1000;
            let price = basePrice;
            
            for (let i = 100; i >= 0; i--) {
                const time = now - (i * 300);
                const open = price;
                const change = (Math.random() - 0.5) * (basePrice * 0.02);
                const close = open + change;
                const high = Math.max(open, close) + Math.random() * (basePrice * 0.01);
                const low = Math.min(open, close) - Math.random() * (basePrice * 0.01);
                
                data.push({ time: Math.floor(time), open, high, low, close });
                price = close;
            }
            
            candlestickSeries.setData(data);
            addPositionLines(symbol);
        }

        // Add position lines to chart
        function addPositionLines(symbol) {
            const signal = signalsDatabase.find(s => s.ticker === symbol);
            if (!signal) return;
            
            if (signal.entry) {
                candlestickSeries.createPriceLine({
                    price: signal.entry,
                    color: '#60a5fa',
                    lineWidth: 2,
                    lineStyle: LightweightCharts.LineStyle.Dashed,
                    axisLabelVisible: true,
                    title: 'Entry',
                });
            }
            
            if (signal.stop) {
                candlestickSeries.createPriceLine({
                    price: signal.stop,
                    color: '#f87171',
                    lineWidth: 2,
                    lineStyle: LightweightCharts.LineStyle.Dashed,
                    axisLabelVisible: true,
                    title: 'Stop',
                });
            }
            
            if (signal.target) {
                candlestickSeries.createPriceLine({
                    price: signal.target,
                    color: '#4ade80',
                    lineWidth: 2,
                    lineStyle: LightweightCharts.LineStyle.Dashed,
                    axisLabelVisible: true,
                    title: 'Target',
                });
            }
        }

        // Load positions
        function loadPositions() {
            const deployed = signalsDatabase.filter(s => s.deployed);
            const pending = signalsDatabase.filter(s => s.status === 'pending');
            
            positions = [...deployed, ...pending];
            renderPositions();
        }

        // Render positions
        function renderPositions() {
            const container = document.getElementById('positions-container');
            container.innerHTML = '';
            
            const deployed = positions.filter(p => p.deployed);
            const pending = positions.filter(p => p.status === 'pending');
            
            // Deployed positions
            deployed.forEach(pos => {
                const pnlColor = pos.pnl >= 0 ? 'var(--color-green)' : 'var(--color-red)';
                const posClass = pos.pnl >= 0 ? 'positive' : 'negative';
                
                container.innerHTML += `
                    <div class="position-row ${posClass} deployed">
                        <div class="position-header">
                            <div>
                                <div class="position-symbol">${pos.ticker}</div>
                                <span class="position-status deployed">DEPLOYED</span>
                            </div>
                            <div class="position-pnl" style="color: ${pnlColor}">
                                ${pos.pnlPct >= 0 ? '+' : ''}${pos.pnlPct.toFixed(1)}%
                            </div>
                        </div>
                        <div class="position-details">
                            <div>Entry: $${pos.entry.toFixed(2)}</div>
                            <div>Current: $${pos.current.toFixed(2)}</div>
                            <div>Stop: $${pos.stop.toFixed(2)}</div>
                            <div>Target: $${pos.target.toFixed(2)}</div>
                            <div>P&L: <span style="color: ${pnlColor}">${pos.pnl >= 0 ? '+' : ''}$${pos.pnl}</span></div>
                            <div>Conv: ${pos.conviction}/10</div>
                        </div>
                        <div class="position-actions">
                            <button class="btn btn-secondary" onclick="loadChart('${pos.ticker}')">CHART</button>
                            <button class="btn btn-danger" onclick="closePosition('${pos.ticker}')">CLOSE</button>
                        </div>
                    </div>
                `;
            });
            
            // Pending positions
            pending.forEach(pos => {
                container.innerHTML += `
                    <div class="position-row pending">
                        <div class="position-header">
                            <div>
                                <div class="position-symbol">${pos.ticker}</div>
                                <span class="position-status pending">PENDING</span>
                            </div>
                            <div style="color: var(--color-yellow); font-weight: 600;">
                                $${(pos.size / 1000).toFixed(0)}k
                            </div>
                        </div>
                        <div class="position-details">
                            <div>Entry: ~$${pos.entry}</div>
                            <div>Stop: $${pos.stop.toFixed(2)}</div>
                            <div>Target: $${pos.target}</div>
                            <div>Conv: ${pos.conviction}/10</div>
                            <div style="grid-column: 1 / 3; color: var(--color-yellow); font-size: 0.75rem;">
                                üìÖ Execute: Monday Feb 9, 9:30 AM EST
                            </div>
                        </div>
                        <div class="position-actions">
                            <button class="btn btn-secondary" onclick="loadChart('${pos.ticker}')">CHART</button>
                            <button class="btn btn-secondary" onclick="editPending('${pos.ticker}')">EDIT</button>
                        </div>
                    </div>
                `;
            });
        }

        // Load signals database
        function loadSignals() {
            renderSignals();
        }

        // Render signals
        function renderSignals() {
            const container = document.getElementById('signals-container');
            container.innerHTML = '';
            
            let filtered = signalsDatabase;
            if (currentFilter !== 'all') {
                filtered = signalsDatabase.filter(s => s.status === currentFilter);
            }
            
            // Sort by conviction (high to low)
            filtered.sort((a, b) => b.conviction - a.conviction);
            
            filtered.forEach(signal => {
                const convClass = signal.conviction >= 8 ? 'high' : signal.conviction >= 6 ? 'medium' : 'low';
                const statusClass = signal.status;
                
                container.innerHTML += `
                    <div class="signal-row ${statusClass}" onclick="loadChart('${signal.ticker}')">
                        <div class="signal-header">
                            <div class="signal-symbol">${signal.ticker}</div>
                            <div class="signal-conviction ${convClass}">${signal.conviction}/10</div>
                        </div>
                        <div class="signal-details">
                            ${signal.status.toUpperCase()} ‚Ä¢ ${signal.source}
                            ${signal.pnl !== undefined ? `<br>P&L: <span style="color: ${signal.pnl >= 0 ? 'var(--color-green)' : 'var(--color-red)'}">${signal.pnl >= 0 ? '+' : ''}$${signal.pnl}</span>` : ''}
                        </div>
                    </div>
                `;
            });
            
            document.getElementById('signals-count').textContent = `${filtered.length} signals`;
        }

        // Load chart for symbol
        function loadChart(symbol) {
            currentSymbol = symbol;
            const signal = signalsDatabase.find(s => s.ticker === symbol);
            if (!signal) return;
            
            document.getElementById('chart-title').textContent = `${symbol}/USD`;
            document.getElementById('quote-symbol').textContent = `${symbol}`;
            
            const price = signal.current || signal.entry || 0;
            document.getElementById('chart-price').textContent = `$${price.toFixed(2)}`;
            document.getElementById('quote-price').textContent = `$${price.toFixed(2)}`;
            
            if (signal.pnlPct !== undefined) {
                const color = signal.pnlPct >= 0 ? 'var(--color-green)' : 'var(--color-red)';
                const arrow = signal.pnlPct >= 0 ? '‚ñ≤' : '‚ñº';
                document.getElementById('quote-change').textContent = `${signal.pnlPct >= 0 ? '+' : ''}${signal.pnlPct.toFixed(1)}% ${arrow}`;
                document.getElementById('quote-change').style.color = color;
            }
            
            document.getElementById('quote-entry').textContent = signal.entry ? `$${signal.entry.toFixed(2)}` : 'N/A';
            document.getElementById('quote-stop').textContent = signal.stop ? `$${signal.stop.toFixed(2)}` : 'N/A';
            document.getElementById('quote-target').textContent = signal.target ? `$${signal.target}` : 'N/A';
            
            loadChartData(symbol, currentInterval);
        }

        // Start price updates
        function startPriceUpdates() {
            setInterval(() => {
                // Simulate price movement
                signalsDatabase.forEach(signal => {
                    if (signal.current) {
                        const change = (Math.random() - 0.5) * 2;
                        signal.current += change;
                        
                        if (signal.entry) {
                            signal.pnl = ((signal.current - signal.entry) / signal.entry) * (signal.size || 10000);
                            signal.pnlPct = ((signal.current - signal.entry) / signal.entry) * 100;
                        }
                    }
                });
                
                renderPositions();
                if (currentSymbol) {
                    loadChart(currentSymbol);
                }
                
                lastUpdate = Date.now();
                document.getElementById('quote-update').textContent = '2s ago üü¢';
            }, 5000);
        }

        // Setup event listeners
        function setupEventListeners() {
            // Chart interval buttons
            document.querySelectorAll('.chart-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.chart-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentInterval = e.target.dataset.interval;
                    loadChartData(currentSymbol, currentInterval);
                });
            });
            
            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentFilter = e.target.dataset.filter;
                    renderSignals();
                });
            });
        }

        // Close position
        function closePosition(ticker) {
            if (confirm(`Close ${ticker} position?`)) {
                const signal = signalsDatabase.find(s => s.ticker === ticker);
                if (signal) {
                    alert(`‚úÖ Position closed!\n${ticker} P&L: ${signal.pnl >= 0 ? '+' : ''}$${signal.pnl.toFixed(0)}`);
                    signal.deployed = false;
                    signal.status = 'passed';
                    loadPositions();
                    renderSignals();
                }
            }
        }

        // Edit pending
        function editPending(ticker) {
            alert(`Edit ${ticker} pending position (feature coming soon)`);
        }

        // Emergency functions
        function closeAllPositions() {
            if (confirm('üî¥ CLOSE ALL POSITIONS?\n\nThis will close all deployed positions at market prices.')) {
                const deployed = signalsDatabase.filter(s => s.deployed);
                const totalPnL = deployed.reduce((sum, s) => sum + (s.pnl || 0), 0);
                
                deployed.forEach(s => {
                    s.deployed = false;
                    s.status = 'passed';
                });
                
                alert(`‚úÖ All positions closed!\nTotal P&L: ${totalPnL >= 0 ? '+' : ''}$${totalPnL.toFixed(0)}`);
                loadPositions();
                renderSignals();
            }
        }

        function pauseTrading() {
            alert('‚è∏Ô∏è Trading paused\n\nAll order entry and automated execution disabled.');
        }

        function showRiskCheck() {
            const deployed = signalsDatabase.filter(s => s.deployed);
            const pending = signalsDatabase.filter(s => s.status === 'pending');
            const totalDeployed = deployed.reduce((sum, s) => sum + ((s.size || 10000)), 0);
            const totalPending = pending.reduce((sum, s) => sum + (s.size || 0), 0);
            const totalPnL = deployed.reduce((sum, s) => sum + (s.pnl || 0), 0);
            const cash = 100000 - totalDeployed - totalPending;
            
            alert(`üìä RISK CHECK\n\nTotal Capital: $100,000\nDeployed: $${totalDeployed.toFixed(0)}\nPending: $${totalPending.toFixed(0)}\nCash: $${cash.toFixed(0)}\n\nOpen Positions: ${deployed.length}\nPending: ${pending.length}\nTotal P&L: ${totalPnL >= 0 ? '+' : ''}$${totalPnL.toFixed(0)}`);
        }

        console.log('üêì ROOSTR Trading Hub - Full Pipeline Ready!');
    </script>
</body>
</html>
